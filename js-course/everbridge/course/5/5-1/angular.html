<!doctype html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <title> Angular </title>
    <meta charset="utf-8">
    <meta name="Generator" content="EditPlus">
    <meta name="Author" content="">
    <meta name="Keywords" content="">
    <meta name="Description" content="">
    <link rel="stylesheet" type="text/css" href="../../../resources/js-course.css">
    <link rel="stylesheet" type="text/css" href="../../../resources/javascripts/plugin/syntax-highlighter/Styles/SyntaxHighlighter.css">
    <link rel="stylesheet" type="text/css" href="../../../resources/css/ember/normalize.css">
    <link rel="stylesheet" type="text/css" href="../../../resources/css/ember/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../../resources/css/ember/style.css">
    <script type="text/javascript" src="../../../resources/javascripts/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="../../../resources/javascripts/plugin/syntax-highlighter/Scripts/shCore.js"></script>
    <script type="text/javascript" src="../../../resources/javascripts/plugin/syntax-highlighter/Scripts/shBrushJScript.js"></script>
    <script type="text/javascript" src="../../../resources/javascripts/plugin/syntax-highlighter/Scripts/shBrushXml.js"></script>
    <script type="text/javascript" src="../../../resources/javascripts/plugin/angular/angular-min.js"></script>
    <script type="text/javascript" src="../../../resources/utils.js"></script>
    <script type="text/javascript" src="../../../resources/ready.js"></script>
    <style type="text/css">
        .done-true {
            text-decoration: line-through;
            color: grey;
        }
    </style>
</head>
<body>
<div class="control_container">
    <a href="../../../index.html">Index</a>
        <span class="control">
            <a href="javascript:" class="openControl">+</a>
            <a href="javascript:" class="closeControl">-</a>
        </span>
    <h2 class="title">Angular 简介</h2>
</div>
<div class="jc_section">
    <h3 class="jc_section_title">Angunlar 起源与理念</h3>
    <div class="jc_section_sub1">
        <h4 class="section_sub_title">Angunlar 起源</h4>
        <div class="section_sub_content">
            Angular.js是2009年由Google工程师Misko Hevery业余时间开发的一个框架，当他把这个框架运用到Google Feedback项目后，前台代码从17000行减少到
            1500行！从此Angular.js称为Google的一个项目，并发展至今。
            <ul>
                <li>Angular不同于其他的MVC框架，他不以字符串的HTML为模版，而是以DOM为模版。</li>
                <li>
                    AngularJS使用了不同的方法，它尝试去补足HTML本身在构建应用方面的缺陷。AngularJS通过使用我们称为标识符(directives)的结构，让浏览器能够识别新的语法。例如：
                    <ul>
                        <li>使用双大括号{{}}语法进行数据绑定；</li>
                        <li>使用DOM控制结构来实现迭代或者隐藏DOM片段；</li>
                        <li>支持表单和表单的验证；</li>
                        <li>能将逻辑代码关联到相关的DOM元素上； </li>
                        <li>能将HTML分组成可重用的组件。 </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
    <div class="jc_section_sub1">
        <h4 class="section_sub_title">Angunlar 理念</h4>
        <div class="section_sub_content">
            Angular信奉的是，当组建视图(UI)同时又要写软件逻辑时，声明式的代码会比命令式的代码好得多，尽管命令式的代码非常适合用来表述业务逻辑。 <br>
            <ul>
                <li>将DOM操作和应用逻辑解耦是一种非常好的思路，它能大大改善代码的可调性；</li>
                <li>将测试和开发同等看待是一种非常非常好的思路，测试的难度在很大程度上取决于代码的结构；</li>
                <li>将客户端和服务器端解耦是一种特别好的做法，它能使两边并行开发，并且使两边代码都能实现重用；</li>
            </ul>
            如果框架能够在整个开发流程里都引导着开发者：从设计UI，到编写业务逻辑，再到测试，那对开发者将是极大的帮助；<br>
            “化繁为简，化简为零”总是好的。<br>
            AngularJS能将你从以下的噩梦中解脱出来：
            <ul>
                <li><b>使用回调：</b>回调的使用会打乱你的代码的可读性，让你的代码变得支离破碎，很难看清本来的业务逻辑。移除一些常见的代码，例如回调，是件好事。大幅度地减少你因为JavaScript这门语言的设计而不得不写的代码，能让你把自己应用的逻辑看得更清楚。</li>
                <li><b>手动编写操作DOM元素的代码：</b>操作DOM是AJAX应用很基础的一部分，但它也总是很“笨重”并且容易出错。用声明的方式描述的UI界面可随着应用状态的改变而变化，能让你从编写低级的DOM操作代码中解脱出来。绝大部分用AngularJS写的应用里，开发者都不用再自己去写操作DOM的代码，不过如果你想的话还是可以去写。 </li>
                <li><b>对UI界面读写数据：</b>AJAX应用的很大一部是CRUD操作。一个经典的流程是把服务端的数据组建成内部对象，再把对象编成HTML表单，用户修改表单后再验证表单，如果有错再显示错误，然后将数据重新组建成内部对象，再返回给服务器。这个流程里有太多太多要重复写的代码，使得代码看起来总是在描述应用的全部执行流程，而不是具体的业务逻辑和业务细节。    </li>
                <li><b>开始前得写大量的基础性的代码：</b>通常你需要写很多的基础性的代码才能实现一个“Hello World”的应用。用AngularJS的话，它会提供一些服务让你很容易地正式开始写你的应用，而这些服务都是以一种Guice-like dependency-injection式的依赖注入自动加入到你的应用中去的,这让你能很快的进入你应用的具体开发。特别的是，你还能全盘掌握自动化测试的初始化过程。 </li>
            </ul>
        </div>
    </div>
</div>
<div class="jc_section">
    <h3 class="jc_section_title">Angunlar 结构</h3>
    <div class="jc_section_sub1">
        <h4 class="section_sub_title">客户端模版（Client-Side Templates）</h4>
        <div class="section_sub_content">
            多页面的Web应用程序都是通过组装和连接服务器上数据来创建HTML, 然后将完成的页面发送到浏览器中.
            大多数的单页应用程序 - 也称为AJAX应用程序 - 这一点做的很好, 在某种程度上. Angular以不同的方式组装模板和数据并推送到浏览器中运行.
            然后服务器将变成给模板提供静态资源和给这些模板提供所需的正确数据的角色.
            <pre name="code" class="xml">
                &lt;html ng-app&gt;
                    &lt;head&gt;
                        &lt;script src="angular.js"&gt;&lt;/script&gt;
                        &lt;script src="controller.js"&gt;&lt;/script&gt;
                    &lt;/head&gt;
                    &lt;body&gt;
                        <div ng-controller="HelloController">
                            <p>{{greeting.text}}, World</p>
                        </div>
                    &lt;/body&gt;
                &lt;/html&gt;
            </pre>
            <pre name="code" class="js">
                function HelloController($scope){
                    $scope.greeting= {text:"Hello "}
                }
            </pre>
            <div id="helloApp">
                <div ng-controller="HelloController">
                    <input ng-model="greeting.text" type="text"/>
                    <p>{{greeting.text}}, World</p>
                </div>
            </div>
            <script type="text/javascript">
                (function(){
                    function HelloController($scope){
                        $scope.greeting = {text:"Hello "}
                    }
                    var module = angular.module("helloApp",[]),dom = document.getElementById("helloApp");
                    module.controller("HelloController",HelloController);
                    angular.bootstrap(dom, ["helloApp"]);
                })();
            </script>
            <p>
                与现在使用广泛的大多数方法相比, 这里有一些有趣的事情需要注意:
                <ul>
                    <li>HTML并没有类或者ID以确定在哪里添加事件监听器.</li>
                    <li>当HelloController设置greeting.text为Hello时, 我们并没有注册任何事件监听器或者编写任何回调函数.</li>
                    <li>HelloController只是一个很普通的JavaScript类, 它并没有继承任何Angular提供的东西.</li>
                    <li>HelloController接收所需的$scope对象, 而无需创建它.</li>
                    <li>我们并没有调用HelloController自身的构造器, 或者在调用它时来计算它.</li>
                </ul>
            </p>
        </div>
    </div>
    <div class="jc_section_sub1">
        <h4 class="section_sub_title">模型/视图/控制器（Model View Controller）(MVC)</h4>
        <div class="section_sub_content">
            MVC背后的核心思想是你可以在你的代码管理中清晰的分离数据(模型), 应用程序逻辑(控制器)以及给用户呈现数据(视图).<br>
            视图从模型中获取数据并显示给用户. 当用户通过点击或者输入与应用程序交互时, 控制器通过改变模型中的数据来响应. 最后, 该模型会通知视图它已经发生改变. 以便它可以更新它显示的信息.<br>
            在Angular应用程序中, 视图就是文档对象模型(DOM), 控制器是JavaScript类, 模型数据存储在对象的属性中.
            <ul>
                <li>模型包含代表你的应用程序当前状态的数据</li>
                <li>视图显示数据</li>
                <li>控制器管理你的模型和视图之间的关系</li>
            </ul>
        </div>
    </div>
    <div class="jc_section_sub1">
        <h4 class="section_sub_title">数据绑定（Data Binding）</h4>
        <div class="section_sub_content">
            常见的AJAX单页应用程序, 像Rails, PHP或者JSP平台都是在通过在发送给用户显示之前将数据合并到HTML字符串中来帮助我们创建用户界面(UI).<br>
            像jQuery这样的库也是将模型扩展到客户端并让我们使用类似的风格, 但是它只有单独更新部分DOM的能力, 而不能更新整个页面. 这里, 我们将数据合并到字符串形式的HTML模板中, 然后通过在一个占位元素中设置innerHTML将返回的结果插入到我们所希望的DOM元素中.<br>
            这一切都工作得很好, 但是当你希望插入新的数据到用户界面(UI)中时, 或者基于用户的输入改变数据, 你需要做一些相当不平凡的工作以确保你的数据状态的准确性, 无论是在用户界面中(UI)还是JavaScript属性中.<br>
            但是如果我们可以不用编写代码就能处理好这一些的工作会怎样? 如果我们可以只需声明用户界面的哪些部分对应JavaScript的哪些属性并让它们自动同步又会怎样? 这种编程风格被称为数据绑定. 由于它是MVC的一项伟大的工程, 便于你编写视图和模型时减少代码, 我们把它引入到了Angular中. 大部分将数据从一处迁移到另一处的工作都会自动完成.
        </div>
    </div>
    <div class="jc_section_sub1">
        <h4 class="section_sub_title">依赖注入（Dependency Injection）</h4>
        <div class="section_sub_content">
            <pre name="code" class="js">
                function HelloController($scope){
                    $scope.greeting= {text:"Hello "}
                }
            </pre>
            依赖注入是对控制器Controller来说的，我们把需要的东西注入到Controller中就是把我们使用的服务通过Controller的参数传递到Controller中。
            要保证你注入的参数名与服务名相同，这样Anguer在解析Controller的时候才能把正确的服务放置到Controller中。<br>
            在HelloController中有很多东西都可以重复, 这里我们并没有编写. 例如, $scope对象将自动绑定数据并传递给我们; <br>
            我们不需要通过调用任何函数来创建它. 我们只是通过将它放置在HelloController的构造器中来访问它.<br>
            正如我们将在后面的章节中会看到, $scope并不是我们唯一可以访问的事物.<br>
            如果我们希望将数据绑定到用户浏览器的URL地址中, 我们可以通过将用于管理它的对象$location放在我们的构造器中来访问它, 就像这样:<br>
            <pre name="code" class="js">
                function HelloController($scope, $location){
                    $scope.greeting = {text: 'Hello'};
                    //use $location for something good here...
                }
            </pre>
            我们通过Angular的依赖注入系统达到这个神奇的效果. 依赖注入让我们得以延续这种开发的风格, 而不需要创建依赖, 我们的类只需要知道它需要什么.
        </div>
    </div>
    <div class="jc_section_sub1">
        <h4 class="section_sub_title">指令（Directives）</h4>
        <div class="section_sub_content">
            Angular最好的部分之一就是你可以如同编写HTML一样编写你的模板. 之所以可以这样做, 是由于这个框架的核心部分我们已经包含了一个的DOM解析引擎, 它允许你扩展HTML的语法.<br>
            我们已经在我们的模板中看到了一些不属于HTML规范的属性. 例如包含在双花括号中的数据绑定, 用于指定哪个控制器对应哪部分视图的ng-controller, 以及给输入框绑定一个模型的ng-model. 这些我们都成为HTML扩展指令. <br>
            Angular带有许多指定, 以帮助你定义应用程序的视图. 很快我们就会看到更多的指令. 这些指令可以定义来我们通常用作视图的模板中. 它们可以用于声明设置你的应用程序如何工作或者创建可复用的组件.<br>
            你并不仅限于使用Angular自带的指令. 你也可以编写你自己的HTML模板扩展, 做你想做的事情.
            <div id="cart" ng-controller="CartController">
                <h1>Your Order</h1>
                <div ng-repeat="item in items">
                    <span style="display: inline-block;width: 100px;">{{item.name}}</span>
                    <input ng-model="item.num" />
                    <span>{{item.price | currency}}</span>
                    <span>{{item.price * item.num | currency}}</span>
                    <button ng-click="remove($index)">Remove</button>
                </div>
            </div>
            <script type="text/javascript">
                (function(){
                    function CartController($scope){
                        $scope.items=[
                            {name:"苹果",num:2,price:2.5},
                            {name:"梨",num:6,price:4.5},
                            {name:"香蕉",num:1,price:5},
                            {name:"葡萄",num:2,price:2}
                        ];
                        $scope.remove = function(index){
                            $scope.items.splice(index,1);
                        }
                    }
                    var module = angular.module("cart",[]),dom = document.getElementById("cart");
                    module.controller("CartController",CartController);
                    angular.bootstrap(dom, ["cart"]);
                })();
            </script>
            <pre name="code" class="xml">
                  <div ng-controller="CartController">
                      <h1>Your Order</h1>
                      <div ng-repeat="item in items">
                          <span  style="display: inline-block;width: 100px;">{{item.name}}</span>
                          <input ng-model="item.num" />
                          <span>{{item.price | currency}}</span>
                          <span>{{item.price * item.num | currency}}</span>
                          <button ng-click="remove($index)">Remove</button>
                      </div>
                  </div>
            </pre>
            <pre name="code" class="js">
                function CartController($scope){
                    $scope.items=[
                       {name:"苹果",num:2,price:2.5},
                       {name:"梨",num:6,price:4.5},
                       {name:"香蕉",num:1,price:5},
                       {name:"葡萄",num:2,price:2}
                    ];
                    $scope.remove = function(index){
                        $scope.items.splice(index,1);
                    }
                }
            </pre>
            让我们从顶部开始:
            <pre name="code" class="xml">
                &lt;html ng-app&gt;
            </pre>
            ng-app属性告诉Angular应该管理页面的哪一部分. 由于我们把它放在&lt;html&gt;元素中, 这将告诉Angular我们希望它管理整个页面. <br>
            这往往也是你所希望的, 但是如果你是结合现有的Angular应用程序来使用其他方式管理页面, 你可能希望把它放在应用程序中的某个&lt;div&gt;中.
            <pre name="code" class="xml">
                &lt;body ng-controller="CartController"&gt;
            </pre>
            在Angular中, 你用于管理页面区域的JavaScript类被称为控制器.<br>
            通过在body标签中包含一个控制器, 我们声明这个CartController将管理&lt;body&gt和&lt;/body&gt之间的所有事物.
            <pre name="code" class="xml">
                &lt;div ng-repeat="item in items"&gt;
            </pre>
            ng-repeat的意思就是对于被称为$items的数组的每一个元素都复制一次&lt;div&gt;中的DOM. <br>
            在每一个复制的div副本中, 我们都会给当前元素设置一个名为item的属性, 因此我们可以在模板中使用它.<br>
            正如你所看到的, 这将导致这三个&lt;div&gt;的每一个都包含产品的标题, 数量, 单价, 总价以及一个用于移除整个项的按钮.
            <pre name="code" class="js">
                &lt;span&gt;{{item.name}}&lt;/span&gt;
            </pre>
            正如我们在"Hello, World"例子中所示, 数据绑定通过{{ }}让我们将变量的值插入到页面部分并保持同步.<br>
            完整的表达式{{item.title}}会迭代检索当前item, 然后将由item的标题属性组成内容插入到DOM中.
            <pre name="code" class="xml">
                &lt;input ng-model="item.num"&gt;
            </pre>
            文本输入字段和item.num的值之间的ng-model定义并创建数据绑定. <br>
            &lt;span&gt;中的{{ }}用于设置一个单向的联系, 意思就是"在这里插入一个值". 这是我们希望的效果, 但是当用户改变单价时应用程序也需要知道, 这样它就能够改变总价.<br>
            我们通过使用ng-model来同步模型中的变化. ng-model声明将item.quantity的值插入到文本域中, 每当用户输入一个新的值时它也能够自动更新item.quantity的值.
            <pre name="code" class="xml">
                <span>{{item.price | currency}}</span>
                <span>{{item.price * item.quantity || currency}}</span>
            </pre>
            我们希望单价和总价被格式化为美元形式. Angular自带了一个称为<span class="red">过滤器</span>的特性让我们可以转换文本,<br>
            这里绑定了一个称为currency的过滤器用于给我们处理这里的美元格式.在下一章我们将会看到更多的过滤器.
            <pre name="code" class="xml">
                &lt;button ng-click="remove($index)"&gt;Remove&lt;/button&gt;
            </pre>
            这允许用户通过点击产品旁边的Remove按钮来从他们的购物车中移除项目. <br>
            我们设置它点击这个按钮时调用remove()函数. 我们还给它传递了一个$index, 它包含了ng-repeat索引值, 因此我们可以知道哪一项将会被移除.
            <pre name="code" class="js">
                function CartController($scope)
            </pre>
            这个CartContoller用于管理购物车的逻辑. 这会告诉Angular, 控制器需要在这里给他设置一个称为$scope的东西. 这个$scope用于让我们在用户界面中将数据绑定到元素中.
            <pre name="code" class="js">
                $scope.items = [
                    {title: 'Paint pots', quantity: 8, price: 3.95},
                    {title: 'Polka dots', quantity: 17, price: 12.95},
                    {title: 'Pebbles', quantity: 5, price: 6.95}
                ];
            </pre>
            通过定义$scope.items, 我们创建了一个虚拟的数据哈希表来描述用户购物车中的物品集. 我们希望它可以用于UI中的数据绑定, 因此将他添加到$scope中. <br>
            当然, 一个真实版本的购物车不可能只在内存中工作, 它需要访问服务器中正确存储的数据. 我们将在后面的章节中讨论这些.<br>
            <pre name="code" class="js">
                $scope.remove = function(index){
                    $scope.items.splice(index, 1);
                }
            </pre>
            我们还希望remove()函数能够用于用户界面中的数据绑定, 因此我们同样将它添加到$scope中.<br>
            对于这个工作在内存中的版本的购物车, remove()函数可以即时从数组中删除项目. 由于&lt;div&gt;列表是通过ng-repeat创建的数据绑定, 所以当项目消失时列表将自动收缩. <br>
            记住, 每当用户在UI上点击一个Remove按钮时, 这个remove()函数就会被调用. <br>
        </div>
    </div>
</div>
</body>
</html>
